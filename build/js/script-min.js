function getHtml(e){return $.get(e,{async:!1},"html")}ProjectCollection=Backbone.Collection.extend({}),function(e,t,n){"function"==typeof define&&define.amd?define(["jquery"],function(o){return n(o,e,t),o.mobile}):n(e.jQuery,e,t)}(this,document,function(e,t,n,o){!function(e,t,n,o){function i(e){for(;e&&void 0!==e.originalEvent;)e=e.originalEvent;return e}function s(t,n){var s,a,r,l,c,u,d,h,p,g=t.type;if(t=e.Event(t),t.type=n,s=t.originalEvent,a=e.event.props,g.search(/^(mouse|click)/)>-1&&(a=I),s)for(d=a.length,l;d;)t[l=a[--d]]=s[l];if(g.search(/mouse(down|up)|click/)>-1&&!t.which&&(t.which=1),-1!==g.search(/^touch/)&&(r=i(s),g=r.touches,c=r.changedTouches,u=g&&g.length?g[0]:c&&c.length?c[0]:o))for(h=0,p=V.length;h<p;h++)t[l=V[h]]=u[l];return t}function a(t){for(var n,o,i={};t;){n=e.data(t,k);for(o in n)n[o]&&(i[o]=i.hasVirtualBinding=!0);t=t.parentNode}return i}function r(t,n){for(var o;t;){if((o=e.data(t,k))&&(!n||o[n]))return t;t=t.parentNode}return null}function l(){X=!1}function c(){X=!0}function u(){G=0,L.length=0,S=!1,c()}function d(){l()}function h(){p(),E=setTimeout(function(){E=0,u()},e.vmouse.resetTimerDuration)}function p(){E&&(clearTimeout(E),E=0)}function g(t,n,o){var i;return(o&&o[t]||!o&&r(n.target,t))&&(i=s(n,t),e(n.target).trigger(i)),i}function m(t){var n,o=e.data(t.target,M);S||G&&G===o||(n=g("v"+t.type,t))&&(n.isDefaultPrevented()&&t.preventDefault(),n.isPropagationStopped()&&t.stopPropagation(),n.isImmediatePropagationStopped()&&t.stopImmediatePropagation())}function f(t){var n,o,s,r=i(t).touches;r&&1===r.length&&(o=a(n=t.target)).hasVirtualBinding&&(G=z++,e.data(n,M,G),p(),d(),B=!1,s=i(t).touches[0],O=s.pageX,x=s.pageY,g("vmouseover",t,o),g("vmousedown",t,o))}function v(e){X||(B||g("vmousecancel",e,a(e.target)),B=!0,h())}function w(t){if(!X){var n=i(t).touches[0],o=B,s=e.vmouse.moveDistanceThreshold,r=a(t.target);(B=B||Math.abs(n.pageX-O)>s||Math.abs(n.pageY-x)>s)&&!o&&g("vmousecancel",t,r),g("vmousemove",t,r),h()}}function $(e){if(!X){c();var t,n,o=a(e.target);g("vmouseup",e,o),B||(t=g("vclick",e,o))&&t.isDefaultPrevented()&&(n=i(e).changedTouches[0],L.push({touchID:G,x:n.clientX,y:n.clientY}),S=!0),g("vmouseout",e,o),B=!1,h()}}function b(t){var n,o=e.data(t,k);if(o)for(n in o)if(o[n])return!0;return!1}function C(){}var y,T,k="virtualMouseBindings",M="virtualTouchID",P="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),V="clientX clientY pageX pageY screenX screenY".split(" "),D=e.event.mouseHooks?e.event.mouseHooks.props:[],I=e.event.props.concat(D),j={},E=0,O=0,x=0,B=!1,L=[],S=!1,X=!1,Y="addEventListener"in n,N=e(n),z=1,G=0;for(e.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},T=0;T<P.length;T++)e.event.special[P[T]]=function(t){var n=t.substr(1);return{setup:function(){b(this)||e.data(this,k,{}),e.data(this,k)[t]=!0,j[t]=(j[t]||0)+1,1===j[t]&&N.bind(n,m),e(this).bind(n,C),Y&&(j.touchstart=(j.touchstart||0)+1,1===j.touchstart&&N.bind("touchstart",f).bind("touchend",$).bind("touchmove",w).bind("scroll",v))},teardown:function(){--j[t],j[t]||N.unbind(n,m),Y&&(--j.touchstart,j.touchstart||N.unbind("touchstart",f).unbind("touchmove",w).unbind("touchend",$).unbind("scroll",v));var o=e(this),i=e.data(this,k);i&&(i[t]=!1),o.unbind(n,C),b(this)||o.removeData(k)}}}(P[T]);Y&&n.addEventListener("click",function(t){var n,o,i,s,a,r=L.length,l=t.target;if(r)for(n=t.clientX,o=t.clientY,y=e.vmouse.clickDistanceThreshold,i=l;i;){for(s=0;s<r;s++)if(a=L[s],0,i===l&&Math.abs(a.x-n)<y&&Math.abs(a.y-o)<y||e.data(i,M)===a.touchID)return t.preventDefault(),void t.stopPropagation();i=i.parentNode}},!0)}(e,0,n),e.mobile={},function(e,t){var o={touch:"ontouchend"in n};e.mobile.support=e.mobile.support||{},e.extend(e.support,o),e.extend(e.mobile.support,o)}(e),function(e,t,o){function i(t,n,i,s){var a=i.type;i.type=n,s?e.event.trigger(i,o,t):e.event.dispatch.call(t,i),i.type=a}var s=e(n),a=e.mobile.support.touch,r=a?"touchstart":"mousedown",l=a?"touchend":"mouseup",c=a?"touchmove":"mousemove";e.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(t,n){e.fn[n]=function(e){return e?this.bind(n,e):this.trigger(n)},e.attrFn&&(e.attrFn[n]=!0)}),e.event.special.scrollstart={enabled:!0,setup:function(){function t(e,t){i(s,(n=t)?"scrollstart":"scrollstop",e)}var n,o,s=this;e(s).bind("touchmove scroll",function(i){e.event.special.scrollstart.enabled&&(n||t(i,!0),clearTimeout(o),o=setTimeout(function(){t(i,!1)},50))})},teardown:function(){e(this).unbind("touchmove scroll")}},e.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var t=this,n=e(t),o=!1;n.bind("vmousedown",function(a){function r(){clearTimeout(u)}function l(){r(),n.unbind("vclick",c).unbind("vmouseup",r),s.unbind("vmousecancel",l)}function c(e){l(),o||d!==e.target?o&&e.preventDefault():i(t,"tap",e)}if(o=!1,a.which&&1!==a.which)return!1;var u,d=a.target;n.bind("vmouseup",r).bind("vclick",c),s.bind("vmousecancel",l),u=setTimeout(function(){e.event.special.tap.emitTapOnTaphold||(o=!0),i(t,"taphold",e.Event("taphold",{target:d}))},e.event.special.tap.tapholdThreshold)})},teardown:function(){e(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),s.unbind("vmousecancel")}},e.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:30,getLocation:function(e){var n=t.pageXOffset,o=t.pageYOffset,i=e.clientX,s=e.clientY;return 0===e.pageY&&Math.floor(s)>Math.floor(e.pageY)||0===e.pageX&&Math.floor(i)>Math.floor(e.pageX)?(i-=n,s-=o):(s<e.pageY-o||i<e.pageX-n)&&(i=e.pageX-n,s=e.pageY-o),{x:i,y:s}},start:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y],origin:e(t.target)}},stop:function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]:t,o=e.event.special.swipe.getLocation(n);return{time:(new Date).getTime(),coords:[o.x,o.y]}},handleSwipe:function(t,n,o,s){if(n.time-t.time<e.event.special.swipe.durationThreshold&&Math.abs(t.coords[0]-n.coords[0])>e.event.special.swipe.horizontalDistanceThreshold&&Math.abs(t.coords[1]-n.coords[1])<e.event.special.swipe.verticalDistanceThreshold){var a=t.coords[0]>n.coords[0]?"swipeleft":"swiperight";return i(o,"swipe",e.Event("swipe",{target:s,swipestart:t,swipestop:n}),!0),i(o,a,e.Event(a,{target:s,swipestart:t,swipestop:n}),!0),!0}return!1},eventInProgress:!1,setup:function(){var t,n=this,o=e(n),i={};(t=e.data(this,"mobile-events"))||(t={length:0},e.data(this,"mobile-events",t)),t.length++,t.swipe=i,i.start=function(t){if(!e.event.special.swipe.eventInProgress){e.event.special.swipe.eventInProgress=!0;var o,a=e.event.special.swipe.start(t),r=t.target,u=!1;i.move=function(t){a&&!t.isDefaultPrevented()&&(o=e.event.special.swipe.stop(t),u||(u=e.event.special.swipe.handleSwipe(a,o,n,r))&&(e.event.special.swipe.eventInProgress=!1),Math.abs(a.coords[0]-o.coords[0])>e.event.special.swipe.scrollSupressionThreshold&&t.preventDefault())},i.stop=function(){u=!0,e.event.special.swipe.eventInProgress=!1,s.off(c,i.move),i.move=null},s.on(c,i.move).one(l,i.stop)}},o.on(r,i.start)},teardown:function(){var t,n;(t=e.data(this,"mobile-events"))&&(n=t.swipe,delete t.swipe,t.length--,0===t.length&&e.removeData(this,"mobile-events")),n&&(n.start&&e(this).off(r,n.start),n.move&&s.off(c,n.move),n.stop&&s.off(l,n.stop))}},e.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe.left",swiperight:"swipe.right"},function(t,n){e.event.special[t]={setup:function(){e(this).bind(n,e.noop)},teardown:function(){e(this).unbind(n)}}})}(e,this)}),CurrentViewModel=Backbone.Model.extend({defaults:{templatePage:"",template:"",lang:document.documentElement.lang},getTemplate:function(){var e="templates/"+this.get("templatePage")+"_"+this.get("lang")+".html";return $.get(e,{async:!1},"html")}}),ProjectModel=Backbone.Model.extend({defaults:{id:"",title:"",icon:"",description_en:"",description_fr:"",icons:"",img:"",video:"",category:"",template:""}}),MenuRouter=Backbone.Router.extend({routes:{"":"callTemplate","*work":"callTemplate","*about":"callTemplate","*contact":"callTemplate"},initialize:function(){},callTemplate:function(e){null===e&&(e="mainPage"),currentViewModel.set({templatePage:e})}}),AboutView=Backbone.View.extend({tagName:"section",initialize:function(){this.render()},render:function(){var e=currentViewModel.get("template");return this.$el.append(e),$(this.el).addClass(currentViewModel.get("templatePage")),$(this.el).addClass("pt-4-5"),$(".currentView").append(this.el),this},close:function(){this.remove(),this.off(),this.unbind()}}),ContactView=Backbone.View.extend({tagName:"section",initialize:function(){this.render()},render:function(){var e=currentViewModel.get("template");return this.$el.append(e),$(this.el).addClass(currentViewModel.get("templatePage")),$(this.el).addClass("pt-4"),$(".currentView").append(this.el),$("#sendButton").click(function(){""!=$("#nameInput").val()&&$("#emailInput").val().includes("@")&&""!=$("#messageInput").val()&&$("#emailSentPopUp").modal("toggle")}),this},close:function(){this.remove(),this.off(),this.unbind()}}),MainPageView=Backbone.View.extend({tagName:"section",initialize:function(){this.render()},render:function(){var e=currentViewModel.get("template");return this.$el.append(e),$(this.el).addClass(currentViewModel.get("templatePage")),$(".currentView").append(this.el),this},close:function(){this.remove(),this.off(),this.unbind()}}),MenuView=Backbone.View.extend({el:$(".menu"),events:{"click #menuIcon":"toggleMenu","mouseenter .unchosen":"backlightMenuOption","mouseleave .unchosen":"backlightMenuOption","click .unchosen":"choosenMenuOption","click .menuIconLink":"choosenMenuOption"},initialize:function(e){this.stayOpen=!1;var t=this;e.on("change:templatePage change:lang",function(){var n=jQuery.Event("click");n.target=$(".menuList").find("#"+e.get("templatePage"))[0],t.choosenMenuOption(n)}),this.render()},render:function(){if("en"===document.documentElement.lang)e="templates/menu_en.html";else if("fr"===document.documentElement.lang)var e="templates/menu_fr.html";return $.get(e,{async:!1},"html").done(function(e){$(".menuList").hasClass("open")?($(".menuList-wrapper").html(e),$(".menuList").addClass("open")):$(".menuList-wrapper").html(e)}),this},toggleMenu:function(){$(".menuList").hasClass("open")?this.menuClose():this.menuOpen()},menuOpen:function(){$("#menuIcon").removeClass("unrotated"),$("#menuIcon").addClass("rotated"),$(".menuList").removeClass("closed"),$(".menuList").addClass("open")},menuClose:function(){var e=this;window.setTimeout(function(){!1===e.stayOpen&&($("#menuIcon").removeClass("rotated"),$("#menuIcon").addClass("unrotated"),$(".menuList").addClass("closed"),$(".menuList").removeClass("open"))},100)},backlightMenuOption:function(e){$(e.target).toggleClass("backlight")},choosenMenuOption:function(e){$(".menuList>a.choosen").removeClass("choosen"),$(e.target).addClass("choosen")},stayMenuOpen:function(e){this.stayOpen=e,!1===e&&this.menuClose()}}),WorkView=Backbone.View.extend({tagName:"section",initialize:function(){var e=this,t=currentViewModel.get("template"),n=$('<section class="grid row justify-content-center"></section>');$(".loading-spiner").toggle(),this.callS3("projects.json").then(function(e){return collection=new ProjectCollection(JSON.parse(e))}).then(function(o){o.each(function(e){n.append(t(e.toJSON()))}),e.render(n,o)})},render:function(e,t){var n=this;return $(".loading-spiner").toggle(),$(this.el).addClass("work"),this.addCategorySort(this.$el),this.$el.append(e),$(".currentView").append(this.el),n.styledGrid(e.children()),this.styleCategoryBar(),this.listenProjectsOverview(e,t),this},callS3:function(e){return new Promise(function(t,n){$.get("/s3",{key:e},function(e,n,o){t(e)})})},addCategorySort:function(e){var t=this;getHtml("templates/workCategory_"+document.documentElement.lang+".html").done(function(n){0!=$(".currentView").find(".categories").length&&$(".categories").remove(),e.prepend(n),$(".categories").on("click touchend",".category, .wiggle",function(){$(".wiggle").hasClass("hover")&&$(".wiggle").removeClass("hover");var e=$(this).attr("data-filter");$(this).addClass("hover"),"*"==e?$(".grid-item").show("1000",function(){t.styledGrid($(".grid-item").filter(e))}):($(".grid-item").not(e).hide("3000",function(){t.styledGrid($(".grid-item").filter(e))}),$(".grid-item").filter(e).show("3000"))})})},styledGrid:function(e){e.each(function(e,t){$(t).hasClass("left")&&$(t).removeClass("left"),$(t).hasClass("right")&&$(t).removeClass("right");parseInt($(t).css("padding-left"));$(t).hasClass("show")||($(t).position().left<=0?$(t).addClass("left"):$(t).addClass("right"))})},styleCategoryBar:function(){$(document).one("scroll",function(){$(".categoryGutter").height($(".categories").height()),$(".categories").addClass("pb-1")})},listenProjectsOverview:function(e,t){var n=this;$(".viewProjectButton").hover(function(e){$(this).parent().find(".projectIcon").toggleClass("greyscale")},function(e){$(this).parent().find(".projectIcon").toggleClass("greyscale")}),e.on("click",".viewProjectButton",function(e){var o=$(this).parent();$(o).toggleClass("hide show").toggleClass("col-lg-6 col-lg-10").toggleClass("height-30vh"),$(o).find(".content").toggleClass("col-lg-6").toggleClass("col-md-8").toggleClass("col-10").toggleClass("col-lg-10").toggleClass("col-md-11").toggleClass("col-12").toggleClass("h-100"),$(o).find(".projectIcon").toggle(),$(o).find(".projectIcon").toggleClass("d-flex"),$(o).find(".viewButtonText").toggle(),o.hasClass("show")?n.showProjectElements(o,t):n.hideProjectElements(o),$("html, body").animate({scrollTop:o.offset().top-$(".menu").height()-$(".categoryGutter").height()},"1000"),n.styledGrid($(".grid").children())})},showProjectElements:function(e,t){var n=t.models[e.index()].attributes;n.lang=currentViewModel.get("lang");var o="templates/projectsTemplates/"+n.template+".html",i=e.find(".content");getHtml(o).done(function(e){var t=_.template(e);i.append(t(n)),i.addClass(n.template+"-template")})},hideProjectElements:function(e){e.find(".content").children().not(":first").remove()},close:function(){this.remove(),this.off(),this.unbind()}});